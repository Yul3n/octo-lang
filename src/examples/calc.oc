open char

type token
  = PLUS
  | MINUS
  | DIV
  | TIMES
  | NUM float

lexer s =
  case s of
    [] -> []
    '+' :: tl -> PLUS :: (lexer tl)
    '-' :: tl -> MINUS :: (lexer tl)
    '/' :: tl -> DIV :: (lexer tl)
    '*' :: tl -> TIMES :: (lexer tl)
    (n :: tl) when (is_num n) -> (lexer "+")

main n =
  case (lexer "2") of
    PLUS :: [MINUS] -> 0
    MINUS :: [PLUS] -> 1
    PLUS :: [] -> 2
